<%- include("partials/navbar") %>

<div class="container mt-4">
  <h1 class="mb-4"><%= team.name %></h1>

<h2>Novinky</h2>
<% if (team.relatedNews && team.relatedNews.length > 0) { %>
  <% team.relatedNews.forEach(post => { %>
    <div class="card mb-3 p-2">
      <h5>
        <a href="/news/<%= post.id %>" class="text-decoration-none"><%= post.title %></a>
      </h5>
      <small class="text-muted"><%= new Date(post.created_at).toLocaleDateString() %></small>
    </div>
  <% }) %>
<% } else { %>
  <p class="text-muted mt-3">No related news yet.</p>
<% } %>





  <h2>Statistika sezóna</h2>
  <table class="table table-sm table-bordered">
    <thead>
      <tr>
        <th>Competition</th>
        <th>Season</th>
        <th>Phase</th>
        <th>Phase Detail</th>
        <th>Matches</th>
        <th>Avg 2min</th>
        <th>Avg 2min Home</th>
        <th>Avg 2min Away</th>
        <th>Avg 5min</th>
        <th>Avg 5min Home</th>
        <th>Avg 5min Away</th>
      </tr>
    </thead>
    <tbody>
      <% team.statsSeason.forEach(s => { %>
        <tr>
          <td><%= s.competition_name %></td>
          <td><%= s.season_name %></td>
          <td><%= s.phase_name || "All Phases" %></td>
          <td><%= s.phasedetail_name || "All" %></td>
          <td><%= s.matches %></td>
          <td><%= s.avg_2min %></td>
          <td><%= s.avg_2min_home %></td>
          <td><%= s.avg_2min_away %></td>
          <td><%= s.avg_5min %></td>
          <td><%= s.avg_5min_home %></td>
          <td><%= s.avg_5min_away %></td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <h2>Statistiky fáze</h2>
  <table class="table table-sm table-bordered">
    <thead>
      <tr>
        <th>Competition</th>
        <th>Season</th>
        <th>Phase</th>
        <th>Phase Detail</th>
        <th>Matches</th>
        <th>Avg 2min</th>
        <th>Avg 2min Home</th>
        <th>Avg 2min Away</th>
        <th>Avg 5min</th>
        <th>Avg 5min Home</th>
        <th>Avg 5min Away</th>
      </tr>
    </thead>
    <tbody>
      <% team.statsPhase.forEach(p => { %>
        <tr>
          <td><%= p.competition_name %></td>
          <td><%= p.season_name %></td>
          <td><%= p.phase_name || "All Phases" %></td>
          <td><%= p.phasedetail_name || "All" %></td>
          <td><%= p.matches %></td>
          <td><%= p.avg_2min %></td>
          <td><%= p.avg_2min_home %></td>
          <td><%= p.avg_2min_away %></td>
          <td><%= p.avg_5min %></td>
          <td><%= p.avg_5min_home %></td>
          <td><%= p.avg_5min_away %></td>
        </tr>
      <% }) %>
    </tbody>
  </table>


  <h2>Statistiky fáze detail</h2>
  <table class="table table-sm table-bordered">
    <thead>
      <tr>
        <th>Competition</th>
        <th>Season</th>
        <th>Phase</th>
        <th>Phase Detail</th>
        <th>Matches</th>
        <th>Avg 2min</th>
        <th>Avg 2min Home</th>
        <th>Avg 2min Away</th>
        <th>Avg 5min</th>
        <th>Avg 5min Home</th>
        <th>Avg 5min Away</th>
      </tr>
    </thead>
    <tbody>
      <% team.statsDetail.forEach(pd => { %>
        <tr>
          <td><%= pd.competition_name %></td>
          <td><%= pd.season_name %></td>
          <td><%= pd.phase_name || "All Phases" %></td>
          <td><%= pd.phasedetail_name || "All" %></td>
          <td><%= pd.matches %></td>
          <td><%= pd.avg_2min %></td>
          <td><%= pd.avg_2min_home %></td>
          <td><%= pd.avg_2min_away %></td>
          <td><%= pd.avg_5min %></td>
          <td><%= pd.avg_5min_home %></td>
          <td><%= pd.avg_5min_away %></td>
        </tr>
      <% }) %>
    </tbody>
  </table>


  <h2>Celkově</h2>
  <ul>
    <li>Matches: <%= team.overall.matches %></li>
    <li>Avg 2min: <%= team.overall.avg_2min %></li>
    <li>Avg 5min: <%= team.overall.avg_5min %></li>
    <li>Avg 2min Home: <%= team.overall.avg_2min_home %></li>
    <li>Avg 2min Away: <%= team.overall.avg_2min_away %></li>
    <li>Avg 5min Home: <%= team.overall.avg_5min_home %></li>
    <li>Avg 5min Away: <%= team.overall.avg_5min_away %></li>
    <li>%>5 2min: <%= team.overall.pct_over_5 %></li>
    <li>%>6 2min: <%= team.overall.pct_over_6 %></li>
    <!-- Add others -->
  </ul>




<h2 class="mb-4">Zápasy týmu</h2>
<table id="teamMatchesTable" class="display" style="width:100%">
  <thead>
    <tr>
      <th>Soutěž</th>
      <th>Sezóna</th>
      <th>Fáze</th>
      <th>Detail fáze</th>
      <th>Domácí vs. Hosté</th>
      <th>Datum</th>
    </tr>
  </thead>
  <tbody>
    <% team.matches.forEach(m => { %>
      <tr>
        <td><%= m.competition_name %></td>
        <td><%= m.season_name %></td>
        <td><%= m.phase_name %></td>
        <td><%= m.phasedetail_name %></td>
        <td><a href="/matches/<%= m.match_id %>"><%= m.home_team %> vs. <%= m.away_team %></a></td>
        <td><%= new Date(m.DateTime).toISOString().slice(0,10) %></td>
      </tr>
    <% }) %>
  </tbody>
</table>




</div>






<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script>
$(document).ready(function() {
  $('#teamMatchesTable').DataTable({
    paging: true,
    searching: true,
    pageLength: 25,
    lengthMenu: [10, 25, 50, 100],
    order: [[5, 'desc']], // default sort by date
    language: {
      search: "Hledat:",
      lengthMenu: "Zobrazit _MENU_ záznamů",
      info: "Zobrazuji _START_ až _END_ z _TOTAL_ záznamů",
      infoEmpty: "Žádné záznamy k dispozici",
      infoFiltered: "(filtrováno z _MAX_ celkových záznamů)",
      zeroRecords: "Nenalezeny žádné odpovídající záznamy",
      emptyTable: "Žádná data v tabulce",
      paginate: {
        first: "První",
        last: "Poslední",
        next: "Další",
        previous: "Předchozí"
      }
    }
  });
});
</script>